# ATEç»©æ•ˆç®¡ç†ç³»ç»Ÿ - éƒ¨ç½²æ€»ç»“

**æ—¥æœŸ**: 2026-02-12  
**å¼€å‘è€…**: ä¹–ä¹– AIåŠ©æ‰‹ ğŸ¾

---

## ğŸ“¦ å·²å®Œæˆçš„å·¥ä½œ

### 1. Dockeré…ç½®æ–‡ä»¶

#### âœ… docker-compose.yml
å®Œæ•´çš„ä¸‰å±‚æ¶æ„é…ç½®:
- **MySQL 8.0**: æ•°æ®åº“æœåŠ¡
  - ç«¯å£: 3306
  - æ•°æ®åº“: performance_db
  - ç”¨æˆ·: performance_user / performance123
  - æ•°æ®æŒä¹…åŒ–: mysql_dataå·
  
- **Backend**: Node.js 20åç«¯æœåŠ¡
  - ç«¯å£: 3001
  - å¥åº·æ£€æŸ¥: /healthç«¯ç‚¹
  - æ—¥å¿—æŒ‚è½½: ./backend/logs
  
- **Frontend**: Nginxå‰ç«¯æœåŠ¡
  - ç«¯å£: 5173 â†’ 80
  - SPAè·¯ç”±æ”¯æŒ
  - Gzipå‹ç¼© + é™æ€èµ„æºç¼“å­˜

#### âœ… backend/Dockerfile
å¤šé˜¶æ®µæ„å»º:
1. **æ„å»ºé˜¶æ®µ**: å®‰è£…ä¾èµ– â†’ ç¼–è¯‘TypeScript
2. **ç”Ÿäº§é˜¶æ®µ**: åªä¿ç•™ç”Ÿäº§ä¾èµ– + ç¼–è¯‘åä»£ç 
3. **ä¼˜åŒ–**: å¥åº·æ£€æŸ¥ + æ—¶åŒºè®¾ç½®

#### âœ… app/Dockerfile
å‰ç«¯æ„å»º + Nginxéƒ¨ç½²:
1. **æ„å»ºé˜¶æ®µ**: npm ci â†’ npm run build
2. **Nginxé˜¶æ®µ**: å¤åˆ¶dist â†’ é…ç½®nginx

#### âœ… app/nginx.conf
Nginxé…ç½®:
- SPAè·¯ç”±: `try_files $uri $uri/ /index.html`
- Gzipå‹ç¼©: æ–‡æœ¬/JS/CSS
- é™æ€èµ„æºç¼“å­˜: 1å¹´
- å®‰å…¨å¤´: X-Frame-Options, X-Content-Type-Options

#### âœ… mysql-init/01-init.sql
æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬:
- åˆ›å»ºæ‰€æœ‰è¡¨ç»“æ„ï¼ˆ11å¼ è¡¨ï¼‰
- è®¾ç½®å­—ç¬¦é›†: utf8mb4
- æ·»åŠ ç´¢å¼•
- å¤–é”®çº¦æŸ

### 2. éƒ¨ç½²è„šæœ¬

#### âœ… deploy.sh
ä¸€é”®éƒ¨ç½²è„šæœ¬ï¼ˆå¯æ‰§è¡Œï¼‰:
- âœ… æ£€æŸ¥Dockerç¯å¢ƒ
- âœ… æ£€æŸ¥ç«¯å£å ç”¨
- âœ… åœæ­¢æ—§æœåŠ¡
- âœ… æ„å»ºé•œåƒ
- âœ… å¯åŠ¨æœåŠ¡
- âœ… å¥åº·æ£€æŸ¥
- âœ… æ˜¾ç¤ºè®¿é—®åœ°å€å’Œæµ‹è¯•è´¦å·

#### âœ… DEPLOY.md
è¯¦ç»†éƒ¨ç½²æ–‡æ¡£:
- å¿«é€Ÿéƒ¨ç½²æ­¥éª¤
- å¸¸ç”¨å‘½ä»¤
- æ•°æ®åº“ç®¡ç†
- æ•…éšœæ’æŸ¥
- æ€§èƒ½ä¼˜åŒ–
- å®‰å…¨å»ºè®®

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### å‰ç½®æ¡ä»¶

**Docker Desktopå®‰è£…ä¸­...**

å½“å‰æ­£åœ¨é€šè¿‡Homebrewå®‰è£…Docker Desktopã€‚å®‰è£…å®Œæˆå:

1. **å¯åŠ¨Docker Desktop**:
   ```bash
   open /Applications/Docker.app
   ```
   
2. **ç­‰å¾…Dockerå°±ç»ª**:
   - èœå•æ Dockerå›¾æ ‡æ˜¾ç¤º"Docker Desktop is running"
   - çº¦éœ€2-3åˆ†é’Ÿåˆå§‹åŒ–

### ä¸€é”®éƒ¨ç½²

```bash
cd /Users/fulingwei/.openclaw/workspace/performance-management

# è¿è¡Œéƒ¨ç½²è„šæœ¬
./deploy.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨:
1. æ£€æŸ¥ç¯å¢ƒ
2. æ„å»ºé•œåƒï¼ˆé¦–æ¬¡çº¦5-8åˆ†é’Ÿï¼‰
3. å¯åŠ¨æœåŠ¡
4. æ˜¾ç¤ºè®¿é—®åœ°å€

### è®¿é—®ç³»ç»Ÿ

éƒ¨ç½²æˆåŠŸå:

- **å‰ç«¯**: http://localhost:5173
- **åç«¯API**: http://localhost:3001/api
- **å¥åº·æ£€æŸ¥**: http://localhost:3001/health

### æµ‹è¯•è´¦å·

| è§’è‰² | ç”¨æˆ·å | å¯†ç  | Role |
|------|--------|------|------|
| ç®¡ç†å‘˜ | admin | admin123 | admin |
| å‘˜å·¥ | å§šæ´ª | 123456 | employee |
| ç»ç† | å®‹é­ | 123456 | manager |
| æ€»ç»ç† | éƒ‘æ±æ‰ | 123456 | gm |

---

## ğŸ“Š ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æµè§ˆå™¨ (localhost:5173)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Frontend       â”‚
         â”‚   (Nginx)        â”‚
         â”‚   Port: 80       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ HTTPè¯·æ±‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Backend         â”‚
         â”‚   (Node.js)       â”‚
         â”‚   Port: 3001      â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ SQLæŸ¥è¯¢
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   MySQL 8.0       â”‚
         â”‚   Port: 3306      â”‚
         â”‚   Volume: æŒä¹…åŒ–   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—„ï¸ æ•°æ®åº“è¡¨ç»“æ„

å·²åˆ›å»ºçš„11å¼ è¡¨:

1. **employees** - å‘˜å·¥ä¿¡æ¯
2. **objectives** - ç›®æ ‡ï¼ˆOKR/KPIï¼‰
3. **goal_progress** - ç›®æ ‡è¿›åº¦è®°å½•
4. **strategic_objectives** - æˆ˜ç•¥ç›®æ ‡
5. **ai_usage_logs** - AIä½¿ç”¨æ—¥å¿—
6. **monthly_performance** - æœˆåº¦ç»©æ•ˆ
7. **promotion_requests** - æ™‹å‡ç”³è¯·
8. **quarterly_summaries** - å­£åº¦æ€»ç»“
9. **peer_reviews** - åŒäº‹äº’è¯„
10. **key_results** - å…³é”®ç»“æœï¼ˆéœ€è¦migrationè¡¥å……ï¼‰
11. **okr_assignments** - OKRåˆ†é…ï¼ˆéœ€è¦migrationè¡¥å……ï¼‰

**æ³¨æ„**: éƒ¨åˆ†è¡¨éœ€è¦é€šè¿‡Supabase migrationæ–‡ä»¶è¡¥å……å®Œæ•´å­—æ®µã€‚

---

## ğŸ“ é¡¹ç›®æ–‡ä»¶ç»“æ„

```
performance-management/
â”œâ”€â”€ docker-compose.yml          # Dockerç¼–æ’
â”œâ”€â”€ deploy.sh                    # éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ DEPLOY.md                    # éƒ¨ç½²æ–‡æ¡£
â”œâ”€â”€ å®‰è£…DockeræŒ‡å—.md            # Dockerå®‰è£…
â”œâ”€â”€ éƒ¨ç½²æ€»ç»“.md                  # æœ¬æ–‡ä»¶
â”‚
â”œâ”€â”€ mysql-init/                  # MySQLåˆå§‹åŒ–
â”‚   â””â”€â”€ 01-init.sql              # è¡¨ç»“æ„SQL
â”‚
â”œâ”€â”€ backend/                     # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ Dockerfile               # åç«¯é•œåƒ
â”‚   â”œâ”€â”€ package.json             # ä¾èµ–
â”‚   â”œâ”€â”€ tsconfig.json            # TypeScripté…ç½®
â”‚   â”œâ”€â”€ src/                     # æºä»£ç 
â”‚   â”‚   â”œâ”€â”€ index.ts             # å…¥å£
â”‚   â”‚   â”œâ”€â”€ config/              # é…ç½®
â”‚   â”‚   â”‚   â””â”€â”€ employees.csv    # å‘˜å·¥æ•°æ®
â”‚   â”‚   â”œâ”€â”€ controllers/         # æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ models/              # æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ routes/              # è·¯ç”±
â”‚   â”‚   â””â”€â”€ middleware/          # ä¸­é—´ä»¶
â”‚   â””â”€â”€ logs/                    # æ—¥å¿—ï¼ˆæŒ‚è½½ï¼‰
â”‚
â””â”€â”€ app/                         # å‰ç«¯åº”ç”¨
    â”œâ”€â”€ Dockerfile               # å‰ç«¯é•œåƒ
    â”œâ”€â”€ nginx.conf               # Nginxé…ç½®
    â”œâ”€â”€ package.json             # ä¾èµ–
    â”œâ”€â”€ tsconfig.json            # TypeScripté…ç½®
    â”œâ”€â”€ src/                     # æºä»£ç 
    â”‚   â”œâ”€â”€ App.tsx              # ä¸»åº”ç”¨
    â”‚   â”œâ”€â”€ pages/               # é¡µé¢
    â”‚   â”œâ”€â”€ components/          # ç»„ä»¶
    â”‚   â”œâ”€â”€ api/                 # APIæœåŠ¡
    â”‚   â””â”€â”€ contexts/            # Context
    â””â”€â”€ dist/                    # æ„å»ºäº§ç‰©
```

---

## âš™ï¸ ç¯å¢ƒå˜é‡

### Backend (.env)

ç”Ÿäº§ç¯å¢ƒå·²é€šè¿‡docker-compose.ymlé…ç½®:

```env
NODE_ENV=production
PORT=3001
DB_HOST=mysql
DB_PORT=3306
DB_NAME=performance_db
DB_USER=performance_user
DB_PASSWORD=performance123
JWT_SECRET=ate_performance_jwt_secret_2026_production
JWT_EXPIRES_IN=7d
ADMIN_DEFAULT_PASSWORD=admin123
USE_MEMORY_DB=false
```

### Frontend (æ„å»ºæ—¶)

```env
VITE_API_URL=http://localhost:3001/api
```

---

## ğŸ”§ å¸¸ç”¨å‘½ä»¤

### æœåŠ¡ç®¡ç†

```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# åœæ­¢æ‰€æœ‰æœåŠ¡
docker-compose down

# é‡å¯æœåŠ¡
docker-compose restart

# æŸ¥çœ‹çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose logs -f backend
docker-compose logs -f frontend
docker-compose logs -f mysql
```

### æ•°æ®åº“æ“ä½œ

```bash
# è¿›å…¥MySQLå®¹å™¨
docker exec -it ate_mysql bash

# è¿æ¥æ•°æ®åº“
docker exec -it ate_mysql mysql -uroot -pperformance123 performance_db

# å¤‡ä»½æ•°æ®åº“
docker exec ate_mysql mysqldump -uroot -pperformance123 performance_db > backup.sql

# æ¢å¤æ•°æ®åº“
docker exec -i ate_mysql mysql -uroot -pperformance123 performance_db < backup.sql

# æŸ¥çœ‹è¡¨åˆ—è¡¨
docker exec -it ate_mysql mysql -uroot -pperformance123 -e "USE performance_db; SHOW TABLES;"

# æŸ¥çœ‹å‘˜å·¥æ•°æ®
docker exec -it ate_mysql mysql -uroot -pperformance123 -e "USE performance_db; SELECT id, name, department, role FROM employees LIMIT 5;"
```

### é‡æ–°æ„å»º

```bash
# é‡æ–°æ„å»ºæ‰€æœ‰é•œåƒ
docker-compose build --no-cache

# é‡æ–°æ„å»ºç‰¹å®šæœåŠ¡
docker-compose build --no-cache backend

# æ„å»ºå¹¶å¯åŠ¨
docker-compose up -d --build
```

---

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜1: ç«¯å£å†²çª

**ç°è±¡**: å¯åŠ¨å¤±è´¥ï¼Œæç¤ºç«¯å£å·²è¢«å ç”¨

**è§£å†³**:
```bash
# æŸ¥çœ‹å ç”¨çš„è¿›ç¨‹
lsof -i :3306
lsof -i :3001
lsof -i :5173

# æ€æ­»è¿›ç¨‹
kill -9 <PID>

# æˆ–ä¿®æ”¹docker-compose.ymlä¸­çš„ç«¯å£æ˜ å°„
```

### é—®é¢˜2: MySQLå¯åŠ¨å¤±è´¥

**ç°è±¡**: Backendæ— æ³•è¿æ¥æ•°æ®åº“

**è§£å†³**:
```bash
# æŸ¥çœ‹MySQLæ—¥å¿—
docker-compose logs mysql

# åˆ é™¤æ•°æ®å·é‡æ–°åˆå§‹åŒ–
docker-compose down -v
docker-compose up -d
```

### é—®é¢˜3: Backendæ„å»ºå¤±è´¥

**ç°è±¡**: TypeScriptç¼–è¯‘é”™è¯¯

**è§£å†³**:
```bash
# æœ¬åœ°æµ‹è¯•æ„å»º
cd backend
npm install
npm run build

# æŸ¥çœ‹é”™è¯¯åä¿®å¤,ç„¶åé‡æ–°æ„å»º
docker-compose build --no-cache backend
```

### é—®é¢˜4: æ•°æ®åˆå§‹åŒ–æ…¢

**ç°è±¡**: é¦–æ¬¡å¯åŠ¨å‘˜å·¥æ•°æ®åŠ è½½æ…¢

**åŸå› **: 173åå‘˜å·¥éœ€è¦é€ä¸€bcryptåŠ å¯†å¯†ç 

**è§£å†³**: ç­‰å¾…2-3åˆ†é’Ÿï¼ŒæŸ¥çœ‹backendæ—¥å¿—ç¡®è®¤å®Œæˆ

```bash
docker-compose logs -f backend | grep "æˆåŠŸåˆå§‹åŒ–"
```

---

## ğŸ”’ ç”Ÿäº§ç¯å¢ƒå®‰å…¨å»ºè®®

âš ï¸ **å½“å‰é…ç½®ä»…é€‚ç”¨äºæœ¬åœ°æµ‹è¯•ï¼**

ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å‰åŠ¡å¿…:

1. **ä¿®æ”¹æ‰€æœ‰é»˜è®¤å¯†ç **:
   - MySQL rootå¯†ç 
   - MySQLç”¨æˆ·å¯†ç 
   - JWT_SECRET
   - ADMIN_DEFAULT_PASSWORD

2. **é™åˆ¶MySQLç«¯å£æš´éœ²**:
   ```yaml
   # docker-compose.ymlä¸­æ³¨é‡Šæ‰
   # ports:
   #   - "3306:3306"
   ```

3. **å¯ç”¨HTTPS**:
   - é…ç½®Nginx SSLè¯ä¹¦
   - ä½¿ç”¨Let's Encrypt

4. **æ·»åŠ åå‘ä»£ç†**:
   - ä½¿ç”¨Nginx/Caddyä½œä¸ºåå‘ä»£ç†
   - éšè—åç«¯ç«¯å£

5. **æ•°æ®å¤‡ä»½**:
   - å®šæ—¶å¤‡ä»½MySQLæ•°æ®
   - å¤‡ä»½ä¸Šä¼ åˆ°äº‘å­˜å‚¨

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### MySQLä¼˜åŒ–

ç¼–è¾‘`docker-compose.yml`:

```yaml
mysql:
  command:
    - --max_connections=200
    - --innodb_buffer_pool_size=1G
    - --query_cache_size=64M
    - --slow_query_log=1
    - --long_query_time=2
```

### Backendä¼˜åŒ–

```yaml
backend:
  environment:
    - NODE_OPTIONS=--max-old-space-size=2048
  deploy:
    resources:
      limits:
        cpus: '2'
        memory: 2G
```

---

## ğŸ“¦ ä¸‹ä¸€æ­¥

éƒ¨ç½²å®Œæˆå:

1. âœ… æµ‹è¯•æ‰€æœ‰åŠŸèƒ½ï¼ˆç™»å½•ã€ç›®æ ‡ç®¡ç†ã€è¿›åº¦è¿½è¸ªã€ä»ªè¡¨æ¿ï¼‰
2. âœ… å¯¼å…¥çœŸå®å‘˜å·¥æ•°æ®ï¼ˆä¿®æ”¹employees.csvï¼‰
3. âœ… é…ç½®Kimi API Keyï¼ˆå¯ç”¨AIåŠŸèƒ½ï¼‰
4. âœ… è®¾ç½®æ•°æ®å¤‡ä»½è®¡åˆ’
5. âœ… ç›‘æ§ç³»ç»Ÿæ€§èƒ½å’Œæ—¥å¿—

---

## ğŸ’¡ æŠ€æœ¯æ ˆæ€»ç»“

| å±‚çº§ | æŠ€æœ¯ | ç‰ˆæœ¬ |
|------|------|------|
| å®¹å™¨ | Docker | 24+ |
| ç¼–æ’ | Docker Compose | 2.0+ |
| æ•°æ®åº“ | MySQL | 8.0 |
| åç«¯ | Node.js | 20 |
| åç«¯æ¡†æ¶ | Express | 5.2 |
| ORM | åŸç”ŸSQL (pg) | - |
| è®¤è¯ | JWT | 9.0 |
| å‰ç«¯ | React | 19 |
| æ„å»ºå·¥å…· | Vite | æœ€æ–° |
| UIåº“ | shadcn/ui | æœ€æ–° |
| å›¾è¡¨ | Recharts | æœ€æ–° |
| WebæœåŠ¡å™¨ | Nginx | Alpine |

---

## ğŸ“ è”ç³»ä¸æ”¯æŒ

- **é¡¹ç›®ä»“åº“**: https://github.com/fulingwei1/performance-management
- **å¼€å‘è€…**: ä¹–ä¹– AIåŠ©æ‰‹ ğŸ¾
- **æ›´æ–°æ—¥æœŸ**: 2026-02-12

---

**ç¥æ‚¨éƒ¨ç½²é¡ºåˆ©ï¼å¦‚æœ‰é—®é¢˜éšæ—¶å‘Šè¯‰æˆ‘ ğŸš€**
