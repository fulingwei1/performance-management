# ç«¯åˆ°ç«¯æµ‹è¯•æŠ¥å‘Š

**æµ‹è¯•æ—¥æœŸ**: 2026-02-12 19:52 GMT+8  
**æµ‹è¯•äºº**: ä¹–ä¹– (OpenClaw Agent)  
**æµ‹è¯•èŒƒå›´**: P1-1, P1-2, P1-3 + æ ¸å¿ƒåŠŸèƒ½å›žå½’  
**æµ‹è¯•çŽ¯å¢ƒ**: Docker (Frontend:5173, Backend:3001, PostgreSQL:5432)

---

## æµ‹è¯•é…ç½®

### æµ‹è¯•è´¦å·
- **å‘˜å·¥**: e001 (å§šæ´ª) / 123456 / employee
- **ç»ç†**: m006 (å®‹é­) / 123456 / manager
- **HR**: hr001 (æž—ä½œå€©) / 123456 / hr
- **Admin**: admin / admin123 / admin

### æœåŠ¡çŠ¶æ€
- âœ… Frontend: http://localhost:5173
- âœ… Backend: http://localhost:3001 (å¥åº·æ£€æŸ¥é€šè¿‡)
- âœ… PostgreSQL: è¿žæŽ¥æ­£å¸¸

---

## æµ‹è¯•ç»“æžœæ€»è§ˆ

| æµ‹è¯•åœºæ™¯ | çŠ¶æ€ | é€šè¿‡çŽ‡ | å¤‡æ³¨ |
|----------|------|--------|------|
| P1-1: ç”³è¯‰æµç¨‹ | ðŸŸ¢ | - | å¾…æµ‹è¯• |
| P1-2: è€ƒæ ¸ç»“æžœå‘å¸ƒ | ðŸŸ¢ | - | å¾…æµ‹è¯• |
| P1-3: ç›®æ ‡å®¡æ‰¹æµç¨‹ | ðŸŸ¢ | - | å¾…æµ‹è¯• |
| æ ¸å¿ƒåŠŸèƒ½å›žå½’ | ðŸŸ¢ | - | å¾…æµ‹è¯• |

---

## è¯¦ç»†æµ‹è¯•è®°å½•

### âœ… P1-1: ç”³è¯‰æµç¨‹ç«¯åˆ°ç«¯æµ‹è¯• (é€šè¿‡)

**æµ‹è¯•åœºæ™¯**: å‘˜å·¥å¯¹ç»©æ•ˆè¯„åˆ†ä¸æ»¡ â†’ æäº¤ç”³è¯‰ â†’ HRå®¡æ‰¹ â†’ å‘˜å·¥æŸ¥çœ‹ç»“æžœ

#### æµ‹è¯•æ­¥éª¤ä¸Žç»“æžœ

**Step 1**: åˆ›å»ºæµ‹è¯•ç»©æ•ˆè®°å½•
- âœ… åˆ›å»º `e2e-test-001` ç»©æ•ˆè®°å½•ï¼ˆ2026-01ï¼Œè¯„åˆ†6.5ï¼‰

**Step 2**: å‘˜å·¥æäº¤ç”³è¯‰
- âœ… API: `POST /api/appeals`
- âœ… ç”³è¯‰ID: `appeal-e001-e2e-test-001-1770897193083`
- âœ… çŠ¶æ€: `pending`
- âœ… ç†ç”±: "æˆ‘è®¤ä¸ºæœ¬æœˆè¯„åˆ†åä½Ž..."

**Step 3**: HRæŸ¥çœ‹å¾…å¤„ç†ç”³è¯‰
- âœ… API: `GET /api/appeals?status=pending`
- âœ… ç»“æžœ: 1æ¡pendingç”³è¯‰
- âœ… æ˜¾ç¤ºå‘˜å·¥å§“å: å§šæ´ª

**Step 4**: HRæ‰¹å‡†ç”³è¯‰
- âœ… API: `PUT /api/appeals/{id}/review`
- âœ… çŠ¶æ€æ›´æ–°: `approved`
- âœ… HRè¯„è®º: "ç»æ ¸å®žï¼Œæ‚¨æœ¬æœˆå·¥ä½œç¡®å®žè¡¨çŽ°ä¼˜ç§€..."
- âœ… HRå§“å: æž—ä½œå€©

**Step 5**: å‘˜å·¥æŸ¥çœ‹ç”³è¯‰ç»“æžœ
- âœ… API: `GET /api/appeals/my`
- âœ… å¯ä»¥çœ‹åˆ°: æ‰¹å‡†çŠ¶æ€ã€HRå§“åã€HRè¯¦ç»†è¯„è®º
- âœ… æ—¶é—´æˆ³: åˆ›å»ºæ—¶é—´å’Œæ›´æ–°æ—¶é—´æ­£ç¡®

**æµ‹è¯•ç»“è®º**: âœ… **å®Œå…¨é€šè¿‡** - ç”³è¯‰æµç¨‹ç«¯åˆ°ç«¯å·¥ä½œæ­£å¸¸

---

### âœ… P1-2: è€ƒæ ¸ç»“æžœå‘å¸ƒæµç¨‹æµ‹è¯• (é€šè¿‡)

**æµ‹è¯•åœºæ™¯**: HRå‘å¸ƒæœˆåº¦è€ƒæ ¸ç»“æžœ â†’ å‘˜å·¥æŸ¥çœ‹å‘å¸ƒçŠ¶æ€

#### æµ‹è¯•æ­¥éª¤ä¸Žç»“æžœ

**Step 1**: æŸ¥è¯¢å·²å‘å¸ƒæœˆä»½
- âœ… API: `GET /api/assessment-publications/published`
- âœ… ç»“æžœ: 2026-01å·²å‘å¸ƒï¼ˆå‘å¸ƒäºº: ç³»ç»Ÿç®¡ç†å‘˜ï¼‰

**Step 2**: HRå‘å¸ƒæ–°æœˆä»½
- âœ… API: `POST /api/assessment-publications/publish`
- âœ… å‘å¸ƒæœˆä»½: 2026-02
- âœ… å‘å¸ƒäºº: hr001 (æž—ä½œå€©)
- âœ… å“åº”æ¶ˆæ¯: "2026-02 çš„è€ƒæ ¸ç»“æžœå·²å‘å¸ƒ"

**Step 3**: å‘˜å·¥æŸ¥è¯¢å‘å¸ƒçŠ¶æ€
- âœ… API: `GET /api/assessment-publications/2026-02/status`
- âœ… `isPublished`: true
- âœ… å‘å¸ƒäººå§“å: æž—ä½œå€©
- âœ… å‘å¸ƒæ—¶é—´: 2026-02-12T11:54:00.857Z

**Step 4**: å–æ¶ˆå‘å¸ƒæµ‹è¯•
- âš ï¸ API: `DELETE /api/assessment-publications/{month}/unpublish`
- âš ï¸ è¿”å›ž: "2026-02 æœªå‘å¸ƒæˆ–å·²å–æ¶ˆ"
- âš ï¸ å¯èƒ½çš„é€»è¾‘é—®é¢˜ï¼Œä½†ä¸å½±å“æ ¸å¿ƒå‘å¸ƒåŠŸèƒ½

**æµ‹è¯•ç»“è®º**: âœ… **æ ¸å¿ƒåŠŸèƒ½é€šè¿‡** - å‘å¸ƒå’ŒæŸ¥è¯¢åŠŸèƒ½æ­£å¸¸å·¥ä½œ

---

### âš ï¸ P1-3: ç›®æ ‡å®¡æ‰¹æµç¨‹æµ‹è¯• (éƒ¨åˆ†é˜»å¡ž)

**æµ‹è¯•åœºæ™¯**: å‘˜å·¥è®¾å®šç›®æ ‡ â†’ æäº¤å®¡æ‰¹ â†’ ç»ç†æ‰¹å‡†/æ‹’ç»

#### æµ‹è¯•æ­¥éª¤ä¸Žç»“æžœ

**Step 1**: å‘˜å·¥åˆ›å»ºä¸ªäººç›®æ ‡
- âŒ API: `POST /api/objectives`
- âŒ é”™è¯¯: "æƒé™ä¸è¶³:å‘˜å·¥åªèƒ½åˆ›å»ºè‡ªå·±çš„ç›®æ ‡"
- ðŸ“ è¯´æ˜Ž: æƒé™é€»è¾‘é™åˆ¶äº†å‘˜å·¥åˆ›å»ºç›®æ ‡

**Step 2**: æ•°æ®åº“ç»“æž„æ£€æŸ¥
- âš ï¸ è¡¨ `strategic_objectives` ç¼ºå°‘ä»¥ä¸‹å®¡æ‰¹å­—æ®µ:
  - `approver_id` - å®¡æ‰¹äººID
  - `approved_by` - æ‰¹å‡†äººID
  - `approved_at` - æ‰¹å‡†æ—¶é—´
  - `rejection_reason` - æ‹’ç»åŽŸå› 

**Step 3**: è¿ç§»æ–‡ä»¶æ£€æŸ¥
- âœ… æ‰¾åˆ°è¿ç§»æ–‡ä»¶: `supabase/migrations/20260212_goal_approval.sql`
- âš ï¸ é—®é¢˜: è¿ç§»æ–‡ä»¶å¼•ç”¨ `objectives` è¡¨å’Œ `users` è¡¨
- âš ï¸ å®žé™…: é¡¹ç›®ä½¿ç”¨ `strategic_objectives` è¡¨å’Œ `employees` è¡¨
- ðŸ“ éœ€è¦: ä¿®æ”¹è¿ç§»æ–‡ä»¶ä»¥åŒ¹é…å®žé™…è¡¨ç»“æž„

**æµ‹è¯•ç»“è®º**: âš ï¸ **éœ€è¦ä¿®å¤è¿ç§»** - åŽç«¯ä»£ç å°±ç»ªï¼Œä½†æ•°æ®åº“è¿ç§»æœªæ‰§è¡Œ

**è§£å†³æ–¹æ¡ˆ**:
1. ä¿®æ”¹ `20260212_goal_approval.sql`:
   - `objectives` â†’ `strategic_objectives`
   - `users` â†’ `employees`
   - `owner_id` å­—æ®µç±»åž‹è°ƒæ•´
2. æ‰§è¡Œä¿®æ”¹åŽçš„è¿ç§»
3. é‡æ–°æµ‹è¯•å®Œæ•´æµç¨‹

---

## ðŸŒ æµè§ˆå™¨æµ‹è¯•æ¸…å• (UIéªŒè¯)

> ä»¥ä¸‹æ¸…å•ä¾›**æ‰‹åŠ¨æµè§ˆå™¨æµ‹è¯•**ä½¿ç”¨ï¼ŒéªŒè¯å‰ç«¯UIå’Œç”¨æˆ·ä½“éªŒ

### ðŸ“‹ P1-1: ç”³è¯‰æµç¨‹ UIæµ‹è¯•

#### å‘˜å·¥ç«¯æµ‹è¯•æ­¥éª¤
1. **ç™»å½•ç³»ç»Ÿ**
   - URL: http://localhost:5173
   - è´¦å·: `e001` / å¯†ç : `123456` / è§’è‰²: `employee`

2. **è¿›å…¥ç»©æ•ˆç”³è¯‰é¡µé¢**
   - ç‚¹å‡»ä¾§è¾¹æ  **"ç»©æ•ˆç”³è¯‰"** èœå•
   - éªŒè¯: é¡µé¢æ­£å¸¸åŠ è½½

3. **æŸ¥çœ‹ç”³è¯‰åˆ—è¡¨**
   - éªŒè¯: å¯ä»¥çœ‹åˆ°ä¹‹å‰æäº¤çš„ç”³è¯‰
   - éªŒè¯: çŠ¶æ€æ˜¾ç¤ºä¸º **"å·²æ‰¹å‡†"** (ç»¿è‰²Badge)
   - éªŒè¯: æ˜¾ç¤ºHRå§“å: **æž—ä½œå€©**
   - éªŒè¯: æ˜¾ç¤ºHRè¯„è®ºå†…å®¹

4. **æäº¤æ–°ç”³è¯‰** (å¯é€‰)
   - ç‚¹å‡» **"æäº¤æ–°ç”³è¯‰"** æŒ‰é’®
   - é€‰æ‹©ç»©æ•ˆè®°å½•: `2026-01`
   - è¾“å…¥ç”³è¯‰ç†ç”±: è‡³å°‘50å­—
   - ç‚¹å‡» **"æäº¤"**
   - éªŒè¯: æˆåŠŸæç¤º + åˆ—è¡¨åˆ·æ–°

#### HRç«¯æµ‹è¯•æ­¥éª¤
1. **ç™»å‡ºå¹¶é‡æ–°ç™»å½•**
   - è´¦å·: `hr001` / å¯†ç : `123456` / è§’è‰²: `hr`

2. **è¿›å…¥ç”³è¯‰ç®¡ç†é¡µé¢**
   - ç‚¹å‡»ä¾§è¾¹æ  **"ç”³è¯‰ç®¡ç†"** èœå•
   - éªŒè¯: é¡µé¢æ­£å¸¸åŠ è½½

3. **æŸ¥çœ‹ç»Ÿè®¡å¡ç‰‡**
   - éªŒè¯: æ˜¾ç¤ºå¾…å¤„ç†/å·²æ‰¹å‡†/å·²æ‹’ç»æ•°é‡
   - éªŒè¯: æ•°å­—ä¸Žå®žé™…æƒ…å†µä¸€è‡´

4. **Tabåˆ‡æ¢**
   - ç‚¹å‡» **"å¾…å¤„ç†"** Tab
   - éªŒè¯: åªæ˜¾ç¤º `status=pending` çš„ç”³è¯‰
   - ç‚¹å‡» **"å·²å¤„ç†"** Tab
   - éªŒè¯: æ˜¾ç¤º `status=approved/rejected` çš„ç”³è¯‰

5. **å¤„ç†ç”³è¯‰**
   - åœ¨å¾…å¤„ç†åˆ—è¡¨ä¸­ï¼Œç‚¹å‡»æŸæ¡ç”³è¯‰çš„ **"å¤„ç†"** æŒ‰é’®
   - å¯¹è¯æ¡†æ‰“å¼€ï¼Œæ˜¾ç¤ºç”³è¯‰è¯¦æƒ…
   - é€‰æ‹© **"æ‰¹å‡†"** æˆ– **"æ‹’ç»"**
   - è¾“å…¥HRè¯„è®º (å¿…å¡«)
   - ç‚¹å‡» **"ç¡®è®¤"**
   - éªŒè¯: æˆåŠŸæç¤º + åˆ—è¡¨åˆ·æ–°

---

### ðŸ“‹ P1-2: è€ƒæ ¸ç»“æžœå‘å¸ƒ UIæµ‹è¯•

#### HRç«¯æµ‹è¯•æ­¥éª¤
1. **è¿›å…¥è€ƒæ ¸ç»“æžœå‘å¸ƒé¡µé¢**
   - ä¾§è¾¹æ : **"è€ƒæ ¸ç»“æžœå‘å¸ƒ"** (æˆ–ç±»ä¼¼èœå•)
   - éªŒè¯: é¡µé¢æ­£å¸¸åŠ è½½

2. **æŸ¥çœ‹å·²å‘å¸ƒæœˆä»½åˆ—è¡¨**
   - éªŒè¯: æ˜¾ç¤ºè¡¨æ ¼ï¼ŒåŒ…å«æœˆä»½ã€å‘å¸ƒäººã€å‘å¸ƒæ—¶é—´
   - éªŒè¯: 2026-01 å’Œ 2026-02 æ˜¾ç¤ºåœ¨åˆ—è¡¨ä¸­

3. **å‘å¸ƒæ–°æœˆä»½**
   - é€‰æ‹©æœˆä»½: `2026-03`
   - ç‚¹å‡» **"å‘å¸ƒ"** æŒ‰é’®
   - ç¡®è®¤å¯¹è¯æ¡†
   - éªŒè¯: æˆåŠŸæç¤º + åˆ—è¡¨åˆ·æ–°

4. **å–æ¶ˆå‘å¸ƒ** (å¦‚æžœåŠŸèƒ½å¯ç”¨)
   - ç‚¹å‡»æŸæ¡è®°å½•çš„ **"å–æ¶ˆå‘å¸ƒ"** æŒ‰é’®
   - ç¡®è®¤å¯¹è¯æ¡†
   - éªŒè¯: æˆåŠŸæç¤º + çŠ¶æ€æ›´æ–°

#### å‘˜å·¥ç«¯æµ‹è¯•æ­¥éª¤
1. **ç™»å½•å‘˜å·¥è´¦å·**
   - è´¦å·: `e001` / å¯†ç : `123456` / è§’è‰²: `employee`

2. **è¿›å…¥æˆ‘çš„ç»©æ•ˆé¡µé¢**
   - ä¾§è¾¹æ : **"æˆ‘çš„ç»©æ•ˆ"** æˆ– **"ç»©æ•ˆè®°å½•"**
   - éªŒè¯: é¡µé¢æ­£å¸¸åŠ è½½

3. **æŸ¥çœ‹å‘å¸ƒçŠ¶æ€å¾½ç« **
   - éªŒè¯: å·²å‘å¸ƒæœˆä»½æ˜¾ç¤º **"å·²å‘å¸ƒ"** å¾½ç«  (ç»¿è‰²)
   - éªŒè¯: æœªå‘å¸ƒæœˆä»½æ˜¾ç¤º **"è‰ç¨¿"** å¾½ç«  (ç°è‰²)
   - éªŒè¯: å‘å¸ƒæ—¶é—´æ­£ç¡®æ˜¾ç¤º

---

### ðŸ“‹ P1-3: ç›®æ ‡å®¡æ‰¹æµç¨‹ UIæµ‹è¯•

> âš ï¸ **æ³¨æ„**: éœ€è¦å…ˆæ‰§è¡Œæ•°æ®åº“è¿ç§»ï¼ˆè§ä¸‹æ–¹ä¿®å¤æ­¥éª¤ï¼‰

#### å‘˜å·¥ç«¯æµ‹è¯•æ­¥éª¤
1. **è¿›å…¥ç›®æ ‡è§„åˆ’é¡µé¢**
   - ä¾§è¾¹æ : **"æˆ‘çš„ç›®æ ‡è§„åˆ’"**
   - éªŒè¯: é¡µé¢æ­£å¸¸åŠ è½½

2. **æŸ¥çœ‹ç›®æ ‡çŠ¶æ€**
   - éªŒè¯: ä¸åŒçŠ¶æ€æ˜¾ç¤ºä¸åŒé¢œè‰²Badge:
     - `draft` - ç°è‰²
     - `pending_approval` - é»„è‰²
     - `approved` - ç»¿è‰²
     - `rejected` - çº¢è‰²

3. **æäº¤ç›®æ ‡å®¡æ‰¹**
   - é€‰æ‹©ä¸€ä¸ª `draft` çŠ¶æ€çš„ç›®æ ‡
   - ç‚¹å‡» **"æäº¤å®¡æ‰¹"** æŒ‰é’®
   - ç¡®è®¤å¯¹è¯æ¡†
   - éªŒè¯: çŠ¶æ€å˜ä¸º **"å¾…å®¡æ‰¹"**

4. **æŸ¥çœ‹è¢«æ‹’ç»çš„ç›®æ ‡**
   - å¦‚æžœæœ‰è¢«æ‹’ç»çš„ç›®æ ‡ï¼ŒéªŒè¯:
     - æ˜¾ç¤ºçº¢è‰²Alertæç¤º
     - æ˜¾ç¤ºæ‹’ç»åŽŸå› 
     - å¯ä»¥é‡æ–°ç¼–è¾‘å¹¶æäº¤

#### ç»ç†ç«¯æµ‹è¯•æ­¥éª¤
1. **ç™»å½•ç»ç†è´¦å·**
   - è´¦å·: `m006` / å¯†ç : `123456` / è§’è‰²: `manager`

2. **è¿›å…¥ç›®æ ‡å®¡æ‰¹é¡µé¢**
   - ä¾§è¾¹æ : **"ç›®æ ‡å®¡æ‰¹"** (ClipboardCheckå›¾æ ‡)
   - éªŒè¯: é¡µé¢æ­£å¸¸åŠ è½½

3. **æŸ¥çœ‹å¾…å®¡æ‰¹åˆ—è¡¨**
   - éªŒè¯: æ˜¾ç¤ºç›´å±žä¸‹å±žæäº¤çš„ç›®æ ‡
   - éªŒè¯: æ˜¾ç¤ºå‘˜å·¥å§“åã€éƒ¨é—¨ã€ç›®æ ‡æ ‡é¢˜

4. **æ‰¹å‡†ç›®æ ‡**
   - ç‚¹å‡»æŸæ¡ç›®æ ‡çš„ **"æ‰¹å‡†"** æŒ‰é’®
   - å¯¹è¯æ¡†ä¸­å¯å¡«å†™æ‰¹å‡†æ„è§ (å¯é€‰)
   - ç‚¹å‡» **"ç¡®è®¤"**
   - éªŒè¯: æˆåŠŸæç¤º + åˆ—è¡¨åˆ·æ–°

5. **æ‹’ç»ç›®æ ‡**
   - ç‚¹å‡» **"æ‹’ç»"** æŒ‰é’®
   - å¯¹è¯æ¡†ä¸­è¾“å…¥æ‹’ç»åŽŸå›  (å¿…å¡«)
   - ç‚¹å‡» **"ç¡®è®¤"**
   - éªŒè¯: æˆåŠŸæç¤º + åˆ—è¡¨åˆ·æ–°

6. **è°ƒæ•´ç›®æ ‡** (å¦‚æžœåŠŸèƒ½å¯ç”¨)
   - ç‚¹å‡» **"è°ƒæ•´"** æŒ‰é’®
   - ä¿®æ”¹ç›®æ ‡å†…å®¹/æƒé‡/ç›®æ ‡å€¼
   - è¾“å…¥è°ƒæ•´åŽŸå› 
   - ç‚¹å‡» **"ç¡®è®¤"**
   - éªŒè¯: æˆåŠŸæç¤º + è°ƒæ•´åŽ†å²è®°å½•

---

## ðŸ”§ P1-3 æ•°æ®åº“è¿ç§»ä¿®å¤æ­¥éª¤

### é—®é¢˜è¯´æ˜Ž
- è¿ç§»æ–‡ä»¶ `20260212_goal_approval.sql` å¼•ç”¨äº† `objectives` å’Œ `users` è¡¨
- å®žé™…é¡¹ç›®ä½¿ç”¨ `strategic_objectives` å’Œ `employees` è¡¨
- éœ€è¦ä¿®æ”¹è¿ç§»æ–‡ä»¶ä»¥åŒ¹é…å®žé™…è¡¨ç»“æž„

### ä¿®å¤æ­¥éª¤

**Step 1**: åˆ›å»ºä¿®æ”¹åŽçš„è¿ç§»æ–‡ä»¶

```bash
cat > ~/.openclaw/workspace/performance-management/postgres-init/03-goal-approval.sql << 'MIGRATION_SQL'
-- P1-3 ç›®æ ‡å®¡æ‰¹åŠŸèƒ½æ•°æ®åº“è¿ç§»
-- ä¸º strategic_objectives è¡¨æ·»åŠ å®¡æ‰¹ç›¸å…³å­—æ®µ

-- æ·»åŠ å®¡æ‰¹ç›¸å…³å­—æ®µ
ALTER TABLE strategic_objectives
  ADD COLUMN IF NOT EXISTS status VARCHAR(50) DEFAULT 'draft',
  ADD COLUMN IF NOT EXISTS approver_id TEXT,
  ADD COLUMN IF NOT EXISTS approved_by TEXT,
  ADD COLUMN IF NOT EXISTS approved_at TIMESTAMP,
  ADD COLUMN IF NOT EXISTS rejection_reason TEXT,
  ADD COLUMN IF NOT EXISTS adjustment_reason TEXT;

-- æ·»åŠ çŠ¶æ€æ£€æŸ¥çº¦æŸ
ALTER TABLE strategic_objectives
  DROP CONSTRAINT IF EXISTS strategic_objectives_status_check;

ALTER TABLE strategic_objectives
  ADD CONSTRAINT strategic_objectives_status_check 
  CHECK (status IN ('draft', 'pending_approval', 'approved', 'rejected', 'active', 'completed', 'cancelled'));

-- æ·»åŠ å¤–é”®çº¦æŸ
ALTER TABLE strategic_objectives
  DROP CONSTRAINT IF EXISTS fk_strategic_objectives_approver;

ALTER TABLE strategic_objectives
  ADD CONSTRAINT fk_strategic_objectives_approver 
  FOREIGN KEY (approver_id) REFERENCES employees(id) ON DELETE SET NULL;

ALTER TABLE strategic_objectives
  DROP CONSTRAINT IF EXISTS fk_strategic_objectives_approved_by;

ALTER TABLE strategic_objectives
  ADD CONSTRAINT fk_strategic_objectives_approved_by 
  FOREIGN KEY (approved_by) REFERENCES employees(id) ON DELETE SET NULL;

-- æ·»åŠ ç´¢å¼•
CREATE INDEX IF NOT EXISTS idx_strategic_objectives_status ON strategic_objectives(status);
CREATE INDEX IF NOT EXISTS idx_strategic_objectives_approver ON strategic_objectives(approver_id);

-- åˆ›å»ºç›®æ ‡è°ƒæ•´åŽ†å²è¡¨ï¼ˆå¦‚æžœä¸å­˜åœ¨ï¼‰
CREATE TABLE IF NOT EXISTS objective_adjustments (
  id TEXT PRIMARY KEY DEFAULT gen_random_uuid()::text,
  objective_id TEXT NOT NULL,
  adjusted_by TEXT NOT NULL,
  adjustment_type VARCHAR(50) NOT NULL,
  old_value TEXT,
  new_value TEXT,
  reason TEXT,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  
  FOREIGN KEY (objective_id) REFERENCES strategic_objectives(id) ON DELETE CASCADE,
  FOREIGN KEY (adjusted_by) REFERENCES employees(id) ON DELETE CASCADE
);

-- æ·»åŠ ç´¢å¼•
CREATE INDEX IF NOT EXISTS idx_adjustments_objective ON objective_adjustments(objective_id);
CREATE INDEX IF NOT EXISTS idx_adjustments_created ON objective_adjustments(created_at DESC);

COMMENT ON TABLE objective_adjustments IS 'ç›®æ ‡è°ƒæ•´åŽ†å²è®°å½•';
COMMENT ON COLUMN objective_adjustments.adjustment_type IS 'è°ƒæ•´ç±»åž‹: target_value, quarterly_targets, monthly_targets, weight, description';
MIGRATION_SQL
```

**Step 2**: æ‰§è¡Œè¿ç§»

```bash
cd ~/.openclaw/workspace/performance-management
docker exec -i ate_postgres psql -U performance_user -d performance_db < postgres-init/03-goal-approval.sql
```

**Step 3**: éªŒè¯è¿ç§»

```bash
# æ£€æŸ¥å­—æ®µæ˜¯å¦æ·»åŠ æˆåŠŸ
docker exec ate_postgres psql -U performance_user -d performance_db -c "
SELECT column_name, data_type 
FROM information_schema.columns 
WHERE table_name = 'strategic_objectives' 
AND column_name IN ('status', 'approver_id', 'approved_by', 'approved_at', 'rejection_reason');
"

# æ£€æŸ¥è¡¨æ˜¯å¦åˆ›å»ºæˆåŠŸ
docker exec ate_postgres psql -U performance_user -d performance_db -c "\d objective_adjustments"
```

**Step 4**: é‡æ–°æµ‹è¯•P1-3åŠŸèƒ½

æ‰§è¡Œä¸Šæ–¹çš„"P1-3: ç›®æ ‡å®¡æ‰¹æµç¨‹ UIæµ‹è¯•"æ¸…å•

---

## ðŸ“Š æµ‹è¯•æ€»ç»“

### æµ‹è¯•ç»Ÿè®¡

| åŠŸèƒ½æ¨¡å— | APIæµ‹è¯• | UIæµ‹è¯• | çŠ¶æ€ |
|----------|---------|--------|------|
| P1-1: ç”³è¯‰æµç¨‹ | âœ… 5/5 é€šè¿‡ | å¾…æµ‹è¯• | ðŸŸ¢ å¯ç”¨ |
| P1-2: è€ƒæ ¸ç»“æžœå‘å¸ƒ | âœ… 3/4 é€šè¿‡ | å¾…æµ‹è¯• | ðŸŸ¢ å¯ç”¨ |
| P1-3: ç›®æ ‡å®¡æ‰¹æµç¨‹ | âš ï¸ é˜»å¡ž | å¾…æµ‹è¯• | ðŸŸ¡ éœ€ä¿®å¤ |

### å‘çŽ°çš„é—®é¢˜

1. **P1-2: å–æ¶ˆå‘å¸ƒåŠŸèƒ½å¼‚å¸¸**
   - çŽ°è±¡: å‘å¸ƒåŽç«‹å³å–æ¶ˆï¼Œè¿”å›ž"æœªå‘å¸ƒ"
   - å½±å“: ä½Žï¼ˆæ ¸å¿ƒå‘å¸ƒåŠŸèƒ½æ­£å¸¸ï¼‰
   - å»ºè®®: æ£€æŸ¥ `assessmentPublicationController.unpublish` é€»è¾‘

2. **P1-3: æ•°æ®åº“è¿ç§»æœªæ‰§è¡Œ**
   - çŽ°è±¡: `strategic_objectives` è¡¨ç¼ºå°‘å®¡æ‰¹å­—æ®µ
   - å½±å“: é«˜ï¼ˆé˜»å¡žç›®æ ‡å®¡æ‰¹åŠŸèƒ½æµ‹è¯•ï¼‰
   - è§£å†³: æ‰§è¡Œä¿®å¤åŽçš„è¿ç§»æ–‡ä»¶ï¼ˆè§ä¸Šæ–¹æ­¥éª¤ï¼‰

3. **P1-3: å‘˜å·¥åˆ›å»ºç›®æ ‡æƒé™é™åˆ¶**
   - çŽ°è±¡: "å‘˜å·¥åªèƒ½åˆ›å»ºè‡ªå·±çš„ç›®æ ‡"é”™è¯¯
   - å½±å“: ä¸­ï¼ˆå¯èƒ½æ˜¯é¢„æœŸè¡Œä¸ºï¼‰
   - å»ºè®®: ç¡®è®¤æƒé™é€»è¾‘æ˜¯å¦ç¬¦åˆä¸šåŠ¡éœ€æ±‚

### ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. âœ… **ç«‹å³å¯åš**: æµè§ˆå™¨æµ‹è¯• P1-1 å’Œ P1-2 UI
2. ðŸ”§ **éœ€ä¿®å¤**: æ‰§è¡Œ P1-3 æ•°æ®åº“è¿ç§»
3. ðŸ§ª **è¿ç§»åŽ**: å®Œæ•´æµ‹è¯• P1-3 ç›®æ ‡å®¡æ‰¹æµç¨‹
4. ðŸ› **å¯é€‰**: ä¿®å¤ P1-2 å–æ¶ˆå‘å¸ƒé€»è¾‘
5. ðŸ“ **æ–‡æ¡£**: æ›´æ–°ç”¨æˆ·æ‰‹å†Œå’Œæ“ä½œæŒ‡å—

---

**æµ‹è¯•æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2026-02-12 19:55 GMT+8  
**æŠ¥å‘Šç”Ÿæˆè€…**: ä¹–ä¹– (OpenClaw Agent)  
**ç³»ç»ŸçŠ¶æ€**: âœ… Backendè¿è¡Œæ­£å¸¸ | âœ… Frontendè¿è¡Œæ­£å¸¸ | âœ… PostgreSQLè¿žæŽ¥æ­£å¸¸

