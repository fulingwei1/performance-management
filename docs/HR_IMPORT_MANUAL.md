# HR数据导入操作手册

## 📋 功能概述

HR数据导入中心提供一站式的人力资源数据导入解决方案，支持：
- ✅ 组织架构批量导入（部门层级关系）
- ✅ 员工名册批量导入（含考核关系）
- ✅ 数据预览和验证
- ✅ 可视化考核关系图
- ✅ 导入错误提示和修正建议

---

## 🚀 快速开始

### 第一步：访问数据导入中心

1. 登录系统（HR账号）
2. 点击左侧菜单【数据导入】
3. 进入四步导入向导

---

## 📥 导入流程详解

### 步骤1：下载模板

系统提供两种标准模板：

#### A. 组织架构模板
**文件名**：`组织架构导入模板.csv`

**字段说明**：

| 字段名 | 必填 | 说明 | 示例 |
|--------|------|------|------|
| 部门编码 | 是 | 唯一标识，建议使用英文+数字 | CEO, HR, TEST |
| 部门名称 | 是 | 显示名称 | 总经办, 人力资源部 |
| 上级部门编码 | 否 | 建立层级关系，顶级部门留空 | CEO, TECH |
| 部门类型 | 是 | company/department/subDepartment | company为根节点 |
| 排序 | 否 | 同级部门排序顺序 | 1, 2, 3 |

**示例数据**：
```csv
部门编码,部门名称,上级部门编码,部门类型,排序
CEO,总经办,,company,1
HR,人力资源部,CEO,department,2
TECH,工程技术中心,CEO,department,3
TEST,测试部,TECH,subDepartment,1
MECH,机械部,TECH,subDepartment,2
```

#### B. 员工名册模板
**文件名**：`员工名册导入模板.csv`

**字段说明**：

| 字段名 | 必填 | 说明 | 示例 |
|--------|------|------|------|
| 员工编号 | 是 | 唯一标识 | E001, M001 |
| 姓名 | 是 | 员工姓名 | 张三, 李四 |
| 部门编码 | 是 | 关联组织架构 | TEST, MECH |
| 岗位 | 是 | 职位名称 | 测试工程师, 经理 |
| 角色 | 是 | employee/manager/gm/hr | employee为员工，manager为经理 |
| 职级 | 是 | senior/intermediate/junior/assistant | senior为高级 |
| 直属上级编号 | 条件 | 员工必填，经理留空 | 填写经理的员工编号 |
| 入职日期 | 否 | 格式：YYYY-MM-DD | 2023-03-15 |
| 手机号 | 否 | 联系方式 | 13800138000 |
| 邮箱 | 否 | 企业邮箱 | zhangsan@company.com |

**示例数据**：
```csv
员工编号,姓名,部门编码,岗位,角色,职级,直属上级编号,入职日期,手机号,邮箱
M001,测试经理,TEST,测试部经理,manager,senior,,2022-01-01,13900000001,manager@company.com
E001,张三,TEST,测试工程师,employee,intermediate,M001,2023-03-15,13800000001,emp@company.com
```

---

### 步骤2：准备您的数据

#### 组织架构设计建议

**三级架构示例**：
```
总经办 (CEO)
├── 人力资源部 (HR)
├── 工程技术中心 (TECH)
│   ├── 测试部 (TEST)
│   ├── 机械部 (MECH)
│   ├── PLC
│   ├── 软件开发部
│   └── 硬件开发部
├── 销售部 (SALES)
│   ├── 销售一部
│   └── 销售二部
├── 客服部 (SERVICE)
└── 项目管理部 (PM)
```

#### 考核关系建立规则

**关键原则**：
1. 每个员工必须有且只有一个直属上级
2. 上级必须是同部门的经理或更高级别管理者
3. 部门经理的"直属上级编号"留空，或填写总经理
4. 总经理的"直属上级编号"必须留空

**示例关系**：
```
总经理 (GM) - 直属上级: 空
  ├── 测试经理 (M001) - 直属上级: 空
  │   ├── 员工1 (E001) - 直属上级: M001
  │   └── 员工2 (E002) - 直属上级: M001
  ├── 机械经理 (M002) - 直属上级: 空
  │   └── 员工3 (E003) - 直属上级: M002
```

---

### 步骤3：上传文件

#### 上传组织架构

1. 点击"选择文件"按钮
2. 选择准备好的组织架构CSV文件
3. 系统自动解析并显示现有部门结构
4. 点击"下一步"

#### 上传员工名册

1. 点击"选择文件"按钮
2. 选择准备好的员工名册CSV文件
3. 等待系统解析
4. 点击"下一步"

---

### 步骤4：数据预览与验证

系统会自动检查以下问题：

#### ✅ 验证通过标志
- 所有必填字段已填写
- 部门编码唯一
- 员工编号唯一
- 角色和职级值合法
- 直属上级编号存在（非经理岗位）

#### ⚠️ 常见错误提示

**错误1：部门编码重复**
```
第5行：部门编码"TEST"已存在
```
**解决**：更换唯一的部门编码

**错误2：直属上级不存在**
```
第10行：直属上级编号"M999"不存在
```
**解决**：检查经理的员工编号是否正确

**错误3：角色值错误**
```
第15行：角色"staff"不合法，必须是 employee/manager/gm/hr 之一
```
**解决**：使用正确的角色值

**错误4：部门未定义**
```
第20行：部门编码"SALES"未在组织架构中定义
```
**解决**：先导入组织架构，确保部门已存在

---

### 步骤5：执行导入

1. 确认预览数据无误
2. 查看导入统计：
   - 待导入部门数量
   - 待导入员工数量
   - 考核关系数量
3. 点击"确认导入数据"
4. 等待导入完成
5. 查看导入结果提示

---

## 👀 查看考核关系图

导入完成后，可以可视化查看考核关系：

1. 点击页面右上角"查看考核关系图"按钮
2. 弹窗显示完整的组织架构和考核链
3. 每个经理卡片显示：
   - 经理姓名和职位
   - 所属部门
   - 考核人数
   - 下属员工列表

**使用场景**：
- 验证考核关系是否正确建立
- 发现遗漏的考核关系
- 了解团队人员分布

---

## 📊 导入后管理

### 查看导入结果

1. **组织架构**：菜单【组织架构】查看部门树
2. **员工列表**：菜单【员工管理】查看所有员工
3. **考核关系**：在考核关系图中查看上下级关系

### 修改已导入数据

如果导入后发现错误：

**单个修改**：
- 组织架构：【组织架构】→ 找到部门 → 编辑
- 员工信息：【员工管理】→ 找到员工 → 编辑

**批量修改**：
1. 导出当前数据（Excel格式）
2. 在Excel中修改
3. 重新使用导入功能（已存在的数据会自动跳过）

---

## 💡 最佳实践

### 1. 数据准备阶段

- ✅ 先在Excel中整理数据，确认无误后再导出CSV
- ✅ 使用统一的编码规则（如E001-E999为员工，M001-M999为经理）
- ✅ 部门编码建议使用英文缩写，便于记忆
- ✅ 预留一些编号空间，方便后续添加新员工

### 2. 导入顺序

**必须遵守的顺序**：
1. 先导入组织架构（建立部门）
2. 再导入员工名册（建立考核关系）

**原因**：员工名册中的"部门编码"必须引用已存在的部门

### 3. 分批导入策略

如果公司员工较多（>100人），建议分批导入：

**第一批**：先导入所有部门经理（建立考核链顶端）
**第二批**：导入各部门员工

### 4. 数据备份

导入前建议：
- 导出当前系统数据作为备份
- 保存好原始Excel文件
- 记录导入时间和数据版本

---

## 🔧 高级功能

### 批量更新

如果需要更新已有员工的信息：

1. 在CSV中包含所有字段
2. 保持员工编号不变
3. 修改其他字段的值
4. 执行导入
5. 系统会自动更新（不会重复创建）

### 导入模板自定义

如果标准模板不满足需求，可以在导入前：
1. 下载标准模板
2. 在Excel中添加自定义列（如工号、座机号等）
3. 系统会忽略不识别的列，只导入标准字段

---

## ❓ 常见问题

### Q1: 导入时提示"编码重复"，但我确认没有重复？

**原因**：可能是之前已经导入过这些数据
**解决**：
- 如果是要更新数据，直接导入即可（会自动跳过或更新）
- 如果是要新建，请更换编码

### Q2: 员工导入成功，但考核关系没建立？

**原因**：直属上级编号错误或经理未导入
**解决**：
1. 检查员工CSV中的"直属上级编号"是否正确
2. 确认上级经理已先导入系统
3. 重新导入员工名册

### Q3: 可以导入后再调整部门吗？

**可以**：
- 在【组织架构】页面可以拖拽调整部门层级
- 在【员工管理】可以批量调整员工部门

### Q4: 员工离职怎么处理？

**建议**：
1. 在员工管理中标记状态为"离职"
2. 将其下属转移到其他经理
3. 不要在系统中删除（保留历史记录）

### Q5: 导入失败如何回滚？

**系统特性**：
- 每次导入是增量操作，不会删除已有数据
- 如果部分失败，成功的数据会保留
- 修正错误后可以重新导入

---

## 📞 技术支持

如遇到以下情况，请联系技术团队：
- 导入大量数据（>500人）时系统超时
- CSV文件解析异常（如乱码问题）
- 考核关系循环引用（A考核B，B又考核A）
- 其他无法解决的导入错误

**提示**：导出时选择UTF-8编码可避免中文乱码
